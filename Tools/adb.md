ssh -L 5555:LOCALHOST:5555 user@TARGETIP -p PORT  
adb connet TARGET:PORT  
adb devices  
adb -s DEVICE shell  
su  
  
  
УСТАНОВКА ADB В LINUX  
Программа ADB входит в стандартный набор утилит Android SDK. Вы можете установить эту среду и получите нужную утилиту. Но не всегда хочется тянуть на компьютер целую среду исполнения. Иногда нужна только одна программа. Ее можно очень просто установить отдельно. В Ubuntu для этого можно выполнить команду:  
  
 sudo apt install android-tools-adb  
  
Для Red Hat, CentOS команда будет немного отличаться:  
  
 sudo yum install android-tools-adb  
  
Если вам нужно установить ADB в Windows, то придется скачать пакет SDK Platform Tools из официального сайта.  
  
  
  
ПОДГОТОВКА СМАРТФОНА  
Для того чтобы вы смогли использовать adb вместе со своим смартфоном вам необходимо включить режим отладки по USB. Эта возможность скрыта во всех версиях Android начиная с 4.2. Чтобы стать разработчиком сначала зайдите в "Настройки" -> "О телефоне" и семь раз нажмите на пункте "Номер сборки":  
  
  
  
  
  
Затем в главном меню настроек появится пункт "Для разработчиков":  
  
  
  
Тут необходимо поставить галочку напротив раздела "Разрешить отладку по USB":  
  
  
  
Теперь ваш телефон готов к работе с adb. Подключите его по USB к вашему компьютеру и начнем работать.  
  
ПОЛЕЗНЫЕ КОМАНДЫ ADB  
Перед тем как мы сможем управлять устройством, необходимо еще кое-что сделать. Команде adb требуется специальная служба для связи с Android необходимо ее запустить. Для этого используйте такую команду:  
  
 adb start-server  
  
  
  
После завершения работы вы можете отключить службу чтобы она не потребляла лишние ресурсы:  
  
 adb kill-server  
  
Теперь можно выполнять adb команды для android.  
  
СПИСОК УСТРОЙСТВ  
Первым делом, посмотрим список подключенных устройств к нашему компьютеру. Для этого используется команда devices:  
  
 adb devices  
  
  
  
Если к системе подключено несколько смартфонов, то по умолчанию действия будут применяться к первому. Но вы можете задать нужное имя устройства с помощью опции -s. Например:  
  
 adb -s 0123456789ABCDEF logcat  
  
Также указать имя устройства, к которому необходимо применять команды программы adb можно с помощью переменной ANDROID_SERIAL:  
  
 export ANDROID_SERIAL=0123456789ABCDEF  
  
Тогда все команды adb будут применяться к устройству, указанному в этой переменной.  
  
СОСТОЯНИЕ УСТРОЙСТВА  
С помощью команды get-state вы можете узнать состояние устройства:  
  
 adb get-state  
  
  
  
Команда вернет одно из значений: device - работает, bootloader - загружается, offline - выключено. С помощью команды status-window можно постоянно отслеживать состояние:  
  
 adb status-window  
  
  
  
ПРОСМОТР ЖУРНАЛОВ  
Самое частое действие, которое приходится делать разработчикам и тестировщикам мобильных приложений в поиске ошибок - это просмотр журналов системы и приложений. Для этого применяется команда logcat:  
  
 adb logcat  
  
  
  
Утилита выводит содержимое логов Android в реальном времени, так что вы сразу увидите все сообщения об ошибках. Также можно записать все в файл:  
  
 adb logcat -d > ~/android.log  
  
С помощью опции -c можно очистить все логи на устройстве:  
  
 adb logcat -c  
  
Не всегда нужно смотреть полный системный лог, иногда будет достаточно только увидеть сообщения нужной программы.. Для этого просто укажите имя пакета:  
  
 adb logcat com android.settings  
  
С помощью опции --log-level можно установить уровень подробности сообщений, доступны такие варианты: V, D, I, W, E, F, S. Для выбора подробности вывода укажите нужную букву через двоеточие после имени приложения:  
  
 adb logcat com android.settings:E  
  
Или выведем только ошибки для всей системы целиком:  
  
 adb logcat *:E  
  
  
  
ПЕРЕДАЧА ФАЙЛОВ НА УСТРОЙСТВО  
Если вам нужно быстро отправить файл на устройство, для этого можно использовать команду push. Вот ее синтаксис:  
  
$ adb push /адрес/локального/файла /адрес/удаленного/файла  
  
Например, загрузим файл из домашней папки на устройство:  
  
 adb push ~/file /sdcard/file  
  
  
  
Файл будет мгновенно передан на устройство и вы можете в этом убедиться. Дополнительно можно использовать опцию -p для отображения прогресса, а также опцию -a чтобы сохранить оригинальный timestamp.  
  
ЗАГРУЗКА ФАЙЛА С УСТРОЙСТВА  
Таким же образом вы можете скачать файл с устройства. Синтаксис команды pull:  
  
$ adb push  /адрес/удаленного/файла /адрес/локального/файла  
  
Например, скопируем отправленный файл обратно:  
  
 adb pull /sdcard/file ~/file1  
  
  
  
УСТАНОВКА ПРИЛОЖЕНИЙ  
С помощью adb можно напрямую устанавливать приложения. Эта возможность может быть очень удобной для разработчиков. Команде install нужно передать только адрес apk файла:  
  
 adb install ~/Momentum_apkpure.com.apk  
  
  
  
После этого приложение установлено и готово к работе на вашем устройстве. Если вам нужно обновить приложение до более новой версии, тогда используйте опцию -r. Это очень важно. Иначе получите ошибку:  
  
 adb -r install~/Momentum_apkpure.com.apk  
  
Еще доступны опции -s - для установки на флешку и -d - для понижения версии программы.  
  
УДАЛЕНИЕ ПРИЛОЖЕНИЙ  
Удалить приложение тоже очень просто. Для этого достаточно передать имя его пакета команде uninstall. Например, удалим браузер Firefox:  
  
 adb uninstall org.mozilla.firefox  
  
РЕЗЕРВНОЕ КОПИРОВАНИЕ  
Вы можете создать резервную копию своей прошивки и всех системных файлов Android для того, чтобы ее потом очень просто и быстро восстановить. Для этого используется команда backup. Сначала рассмотрим ее синтаксис:  
  
$ adb backup опции пакеты  
  
Опции указывают какие данные нужно копировать. Каждая опция может иметь приставку no, которая означает, что эти данные копировать не нужно. Рассмотрим основные опции:  
  
-apk - сохранять apk файлы для программ, по умолчанию отключено;  
-obb - сохранять расширения установленные расширения apk файлов в формате obb. По умолчанию отключено;  
-shared - сохранять данные приложений из SD карты или памяти телефона, отключено;  
-all - сохранить все установленные приложения;  
-system - сохранить системные приложения, эти приложения уже входят в список all.  
Последний параметр позволяет указать какие приложения нужно сохранять. Если указана опция all, то, естественно, что этот параметр не нужен. Таким образом, команда для резервного копирования системы будет выглядеть вот так:  
  
 adb backup -apk -obb -shared -all -f backup.ab  
  
С помощью опции -f мы задаем имя файла архива, он будет сохранен в текущей папке. Если его не задать, то имя по умолчанию будет backup.ab. Вам нужно будет подтвердить создание копии на телефоне, можно ввести пароль для шифрования:  
  
  
  
   
  
Для восстановления из резервной копии используйте команду restore. Ей достаточно передать адрес файла:  
  
 adb restore android.ab  
  
ПЕРЕЗАГРУЗКА УСТРОЙСТВА  
В утилиты adb есть даже команды для перезагрузки устройства. Можно просто перезагрузить смартфон с помощью команды reboot:  
  
 adb reboot  
  
Можно загрузиться в режим recovery:  
  
 adb reboot recovery  
  
Или в режим настройки загрузчика:  
  
 adb reboot bootloader  
  
КОНСОЛЬ ANDROID  
С помощью команды shell вы можете войти в консоль Android и выполнять там необходимые действия. Здесь доступно большинство привычных нам команд linux. Мы подробно рассматривали все доступные команды в статье команды Android Terminal Emulator. Сейчас же поговорим про саму команду shell и приведем несколько примеров. Чтобы войти в консоль наберите:  
  
 adb shell  
  
  
  
Дальше откроется командная строка adb на Android. Если вам не нужна консоль, а нужно только выполнить команду и вернуть результат, то вы можете передать команду сразу после shell:  
  
 adb shell ls /system  
  
  
  
Например, с помощью такой команды вы можете сделать снимок экрана:  
  
 adb shell screencap -p /sdcard/screenshot.png  
  
А так можно снять экран смартфона на видео:  
  
 adb shell screenrecord /sdcard/video.mp4